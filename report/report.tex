%
% $Id$
% $Author$
% $Date$
% $Rev: 34 $
%

%\documentclass[10pt,a4paper,twoside,openright]{scrartcl}
\documentclass[10pt,a4paper]{scrartcl}
\usepackage{extsizes}
\usepackage[utf8]{inputenc}
\usepackage[english,ngerman]{babel}
\usepackage[T1]{fontenc}
\usepackage{fix-cm}
\usepackage{lmodern}
\usepackage{lipsum}

\usepackage{commath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}

\usepackage{caption}
\usepackage{ragged2e}

%\usepackage[left=3.1cm, right=3.1cm]{geometry}
\usepackage{graphicx}
%\usepackage[export]{adjustbox}

\usepackage{epstopdf}
\epstopdfDeclareGraphicsRule{.tif}{png}{.png}{convert #1 \OutputFile}
\AppendGraphicsExtensions{.tif}

\usepackage{float}
\usepackage{subfig}
\usepackage{sidecap}
\usepackage[bottom]{footmisc}

\usepackage{color}
\definecolor{codeblue}{rgb}{0,0,0.3}
\definecolor{codegreen}{rgb}{0,0.3,0}
\definecolor{codered}{rgb}{0.3,0,0}
\definecolor{Gray}{gray}{0.9}
\usepackage[scaled]{beramono}
\usepackage{listings}
\usepackage{needspace}
\lstset{%
  basicstyle=\footnotesize\ttfamily,
  frame=single, %line/leftline/single
  aboveskip=\topsep,
  belowskip=\topsep,
  breakatwhitespace=true,
  showstringspaces=false,
  breaklines=true,
  commentstyle=\itshape\color{codegreen},
  keywordstyle=\bfseries\color{codeblue},
  stringstyle=\color{codered},
  captionpos=t\/
}
\captionsetup[lstlisting]{font=footnotesize}
\newcommand{\mylisting}[2][]{%
  \lstinputlisting[caption={\texttt{\detokenize{#2}}},#1]{#2}%
}

\usepackage{booktabs}
\usepackage{longtable}
\usepackage{color, colortbl}
\usepackage{multirow}
\usepackage{varwidth}
\usepackage{pgfplotstable}

\definecolor{blue}{rgb}{0,0,0.32}
\usepackage[pdfauthor={M. Deineko},
            pdfproducer={pdflatex},
            pdfcreator={LaTeX},
            colorlinks=true,
            linkcolor=blue,
            urlcolor=blue,
            linktoc=section,
            unicode=true
            ]{hyperref}
\hypersetup{pdftitle=TSP on Relaxed SUpnick Matrices}

\usepackage[title,page,toc]{appendix}
\newcommand*{\Appendixautorefname}{Appendix}
\usepackage{cleveref}

\usepackage{verbatim}
\usepackage{cprotect}

\usepackage{afterpage}
%\makeatletter
%\def\verbatim@font{\normalfont\itshape}
%\makeatother
\newcommand\blankpage{%
  \null%
  \thispagestyle{empty}%
  %\addtocounter{page}{-1}%
  \vspace*{\fill}
  \centering
  {\em {\small
  This page would have been intentionally left blank had we not chosen to
  \href{https://en.wikipedia.org/wiki/Recursion}{mention it}.
  }}%
  %\verbatiminput{|"/usr/games/fortune"}
  \vspace{\fill}%
  \newpage
}

\usepackage[backend=biber]{biblatex}
%\usepackage[fixlanguage]{babelbib}
\addbibresource{references.bib}
\usepackage[nottoc]{tocbibind}

%\usepackage[toc]{multitoc}
\usepackage[subfigure]{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

\begin{document}

\selectlanguage{english}

\title{TSP on Relaxed Supnick Matrices}
\subtitle{Theory and Implementation}
\input{authors.tex}
\date{\today}
\maketitle
\thispagestyle{empty}

%\setlength{\cftbeforetoctitleskip}{-2em}
\tocloftpagestyle{empty}
\tableofcontents
\afterpage{\blankpage}

%\setlength{\parindent}{0cm}

\clearpage
\section{Theory}
\subsection{Relaxed Supnick matrices}
\subsection{Strongly balanced tours}

Let
\[ \Phi_k\left(\big\{ \{a_1,b_1\}, \ldots ,\{a_p,b_p\} \big\} \right) \]
denote shortest (in total length) balanced paths set containing points $1 \ldots k$
with $a_i, b_i$ being the paths' endpoints
and
\[ B\left(\big\{ \{a_1,b_1\}, \ldots ,\{a_p,b_p\} \big\}\right) = \bigcup_i\{a_i,b_i\}.\]
Then following holds:
\begin{enumerate}
  \item
\[
  \Phi_k\left(\big\{ \{a_1\}, \ldots , \{a_k\} \big\} \right) =
  \left\{ \left< a_1 \right> , \ldots , \left< a_k \right> \right\}
\]
  \item
\[
  \Phi_k\left(\big\{ s_1, \ldots , s_p, \{k\} \big\} \right) =
  \Phi_{k-1}\left(\big\{ s_1, \ldots , s_p \big\}\right) \cup
  \left\{\left<k\right>\right\}
\]
  \item
\[
  \Phi_k\left(\big\{ s_1, \ldots , s_p, \{r,k\} \big\} \right) =
  append\left(\Phi^{*},z^{\ast},k\right)
\]
where
\[
  \Phi^{*} = \Phi_{k-1}\left(\big\{ s_1, \ldots , s_p, \{r,z^{*}\} \big\} \right)
\]
\[
  z^{*} = \argmin_{z \in [1,\ldots,m]}{
    \left(
      length \;
      \Phi_{k-1}\left(\big\{ s_1, \ldots , s_p, \{r,z\} \big\} \right)
      + d(z,k)
    \right)
  }
\]
\[
  m = \min B\left(\{s_1, \ldots ,s_p\}\right) \cup \{k\} - 1
\]
  \item
\[
  \Phi_k\left(\left\{ s_1, \ldots , s_p \right\} \right) =
  \;\text{with}\;
  k \notin B\left({s_1,\ldots,s_p}\right)
\]
is then chosen from two possible solutions:
\begin{enumerate}
  \item
\[
  merge\left(\Phi_{q^{*}},z^{*},z^{**},k\right)
\]
where
\[
  \Phi_{q^{*}} = \Phi_{k-1}\left(\big\{ s_1, \ldots , s_{q^{*}-1},
  \{z^{*},a^{*}\}, \{b^{*},z^{**}\}, s_{q^{*}+1}, \ldots, s_p \big\} \right)
\]
\[
  s_{q^{*}} = \{a^{*},b^{*}\}
\]
\[
  (q^{*}, z^{*},z^{**}) = \argmin_{
    \substack{q \in [1,p] \\\
              z^\prime \in [1,\ldots,m-1] \\\
              z^{\prime\prime} \in [z^\prime+1, m-1]}}{
    \mkern-18mu \Phi_{k-1}\left(\big\{ s_1, \ldots , s_{q-1},
    \{z^{\prime},a\}, \{b,z^{\prime\prime}\},
    s_{q+1}, \ldots ,s_p \big\} \right)
    \! + \! d(z^\prime,a) \! + \! d(z^{\prime\prime},b)
  }
\]
\[
  m = \min B\left(\{s_1,\ldots,s_p\}\right)
\]
  \item
\[
  merge\left(\Phi^{*},z^{*},z^{**},k\right)
\]
for
\[
  s_p = \{m,r\}, m = \min B\left(\{s_1,\ldots,s_p\}\right), m \neq r
\]
where
\[
  \Phi^{*} = \Phi_{k-1}\left(\big\{ s_1, \ldots , s_{p-1}, \{z^{*},m\}, \{r,z^{**}\} \big\} \right)
\]
\[
  (z^{*},z^{**}) = \argmin_{\substack{z^\prime \in [1,\ldots,m-1] \\\
  z^{\prime\prime} \in [m+1, \min B\left(\{s_1,\ldots,s_{p-1}\}\right)-1]}}{
    \mkern-28mu \mkern-18mu
    \Phi_{k-1}\left(\big\{ s_1, \ldots , s_{p-1},
    \{z^{\prime},m\}, \{r,z^{\prime\prime}\} \big\} \right)
    + d(z^\prime,m) + d(z^{\prime\prime},r)
  }
\]
\end{enumerate}
\end{enumerate}

\subsection{Dynamic programming and polynomial runtime}
\section{Implementation}
\subsection{Dynamic programming --- a functional approach}
\subsection{Implementation details}
\subsection{Local search extention}
\section{Benchmarks}
\subsection{Synthetic tests}
\subsection{TSPLib}
\subsection{TSP Challenge}
\section{Applicability}
\subsection{Local search results}
\subsection{Relaxed instances and special cases}
\section{Concurrency}
\subsection{Concurrent ML}
\subsection{Clojure}
\section{Areas for Further Research}
%\input{problem1.tex}

\clearpage
\begin{appendices}
%\section{Code Index}
%\lstlistoflistings%
%\section{Some Code}
%\label{app:p1code}
%\input{problem1app.tex}
%\clearpage
\end{appendices}

\printbibliography%

\end{document}

